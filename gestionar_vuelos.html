<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gestión de Vuelos</title>
    <link
      href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-validate/1.14.0/jquery.validate.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
  </head>
  <body>
    <div class="container mt-5">
      <h1 class="text-center">Gestión de Vuelos</h1>
      <div class="d-flex justify-content-between">
        <button
          type="button"
          class="btn btn-primary"
          data-toggle="modal"
          data-target="#addFlightModal"
        >
          Añadir Vuelo
        </button>
        <button
          type="button"
          class="btn btn-primary"
          data-toggle="modal"
          data-target="#searchFlightModal"
        >
          Buscar Vuelos
        </button>
      </div>
      <table class="table table-striped mt-3">
        <thead>
          <tr>
            <th>ID Vuelo</th>
            <th>Fecha de Partida</th>
            <th>Fecha de Llegada</th>
            <th>País de Origen</th>
            <th>País Destino</th>
            <th>Modelo de Avión</th>
            <th>Capacidad Máx</th>
            <th>Cantidad de Pasajes Disponibles</th>
          </tr>
        </thead>
        <tbody id="flightTableBody">
          <!-- Los datos se añadirán aquí dinámicamente -->
        </tbody>
      </table>
    </div>

    <!-- Modal para Añadir Vuelo -->
    <div class="modal fade" id="addFlightModal" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">
              &times;
            </button>
            <h4 class="modal-title">Añadir Vuelo</h4>
          </div>
          <form role="form" id="addFlightForm">
            <div class="modal-body">
              <div class="form-group">
                <label class="control-label" for="flightId">ID Vuelo:</label>
                <input
                  type="text"
                  class="form-control"
                  id="flightId"
                  name="flightId"
                  required
                />
              </div>
              <div class="form-group">
                <label class="control-label" for="departureDate"
                  >Fecha de Partida:</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="departureDate"
                  name="departureDate"
                  required
                />
              </div>
              <div class="form-group">
                <label class="control-label" for="arrivalDate"
                  >Fecha de Llegada:</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="arrivalDate"
                  name="arrivalDate"
                  required
                />
              </div>
              <div class="form-group">
                <label class="control-label" for="originCountry"
                  >País de Origen:</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="originCountry"
                  name="originCountry"
                  required
                />
              </div>
              <div class="form-group">
                <label class="control-label" for="destinationCountry"
                  >País Destino:</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="destinationCountry"
                  name="destinationCountry"
                  required
                />
              </div>
              <div class="form-group">
                <label class="control-label" for="airplaneModel"
                  >Modelo de Avión:</label
                >
                <select
                  class="form-control"
                  id="airplaneModel"
                  name="airplaneModel"
                  required
                >
                  <option value="">Selecciona un modelo</option>
                  <option value="Boeing 747">Boeing 747</option>
                  <option value="Airbus A380">Airbus A380</option>
                  <option value="Boeing 777">Boeing 777</option>
                  <option value="Airbus A320">Airbus A320</option>
                </select>
              </div>
              <div class="form-group">
                <label class="control-label" for="maxCapacity"
                  >Capacidad Máx:</label
                >
                <input
                  type="number"
                  class="form-control"
                  id="maxCapacity"
                  name="maxCapacity"
                  required
                />
              </div>
              <div class="form-group">
                <label class="control-label" for="availablePassengers"
                  >Cantidad de Pasajes Disponibles:</label
                >
                <input
                  type="number"
                  class="form-control"
                  id="availablePassengers"
                  name="availablePassengers"
                  required
                />
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-default"
                data-dismiss="modal"
              >
                Cerrar
              </button>
              <button type="submit" class="btn btn-success" id="btnSaveIt">
                Guardar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Modal para Buscar Vuelos -->
    <div class="modal fade" id="searchFlightModal" role="dialog">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal">
              &times;
            </button>
            <h4 class="modal-title">Buscar Vuelos</h4>
          </div>
          <form role="form" id="searchFlightForm">
            <div class="modal-body">
              <div class="form-group">
                <label class="control-label" for="searchDepartureDate"
                  >Fecha de Partida:</label
                >
                <input
                  type="date"
                  class="form-control"
                  id="searchDepartureDate"
                  name="searchDepartureDate"
                />
              </div>
              <div class="form-group">
                <label class="control-label" for="searchOriginCountry"
                  >País de Origen:</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="searchOriginCountry"
                  name="searchOriginCountry"
                />
              </div>
              <div class="form-group">
                <label class="control-label" for="searchDestinationCountry"
                  >País Destino:</label
                >
                <input
                  type="text"
                  class="form-control"
                  id="searchDestinationCountry"
                  name="searchDestinationCountry"
                />
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-default"
                data-dismiss="modal"
              >
                Cerrar
              </button>
              <button type="submit" class="btn btn-success" id="btnSearchIt">
                Buscar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <script>
      $(document).ready(function () {
        $("#addFlightForm").validate({
          rules: {
            flightId: {
              required: true,
              minlength: 2,
            },
            departureDate: {
              required: true,
              date: true,
            },
            arrivalDate: {
              required: true,
              date: true,
            },
            originCountry: {
              required: true,
              minlength: 2,
            },
            destinationCountry: {
              required: true,
              minlength: 2,
            },
            airplaneModel: {
              required: true,
            },
            maxCapacity: {
              required: true,
              min: 1,
            },
            availablePassengers: {
              required: true,
              min: 0,
              max: function () {
                return $("#maxCapacity").val();
              },
            },
          },
          messages: {
            flightId: {
              required: "Por favor, introduce un ID de vuelo.",
              minlength: "El ID de vuelo debe tener al menos 2 caracteres.",
            },
            departureDate: {
              required: "Por favor, selecciona una fecha de partida.",
              date: "Por favor, introduce una fecha válida.",
            },
            arrivalDate: {
              required: "Por favor, selecciona una fecha de llegada.",
              date: "Por favor, introduce una fecha válida.",
            },
            originCountry: {
              required: "Por favor, introduce un país de origen.",
              minlength: "El país de origen debe tener al menos 2 caracteres.",
            },
            destinationCountry: {
              required: "Por favor, introduce un país de destino.",
              minlength: "El país de destino debe tener al menos 2 caracteres.",
            },
            airplaneModel: {
              required: "Por favor, selecciona un modelo de avión.",
            },
            maxCapacity: {
              required: "Por favor, introduce una capacidad máxima.",
              min: "La capacidad máxima debe ser al menos 1.",
            },
            availablePassengers: {
              required:
                "Por favor, introduce la cantidad de pasajes disponibles.",
              min: "La cantidad de pasajes disponibles debe ser al menos 0.",
              max: "La cantidad de pasajes disponibles no puede ser mayor que la capacidad máxima.",
            },
          },

          submitHandler: function (form) {
            addFlightToTable(form);
          },
        });

        $("#searchFlightForm").validate({
          rules: {
            searchDepartureDate: {
              date: true,
            },
            searchOriginCountry: {
              minlength: 2,
            },
            searchDestinationCountry: {
              minlength: 2,
            },
          },
          messages: {
            searchDepartureDate: {
              date: "Por favor, introduce una fecha válida.",
            },
            searchOriginCountry: {
              minlength: "El país de origen debe tener al menos 2 caracteres.",
            },
            searchDestinationCountry: {
              minlength: "El país de destino debe tener al menos 2 caracteres.",
            },
          },
          submitHandler: function (form) {
            form.submit();
          },
        });
      });
      $("#addFlightForm").on("submit", function (event) {
          event.preventDefault();
          var flightId = $("#flightId").val();
          var departureDate = $("#departureDate").val();
          var arrivalDate = $("#arrivalDate").val();
          var originCountry = $("#originCountry").val();
          var destinationCountry = $("#destinationCountry").val();
          var airplaneModel = $("#airplaneModel").val();
          var maxCapacity = $("#maxCapacity").val();
          var availablePassengers = $("#availablePassengers").val();

          var newRow = `
            <tr>
              <td>${flightId}</td>
              <td>${departureDate}</td>
              <td>${arrivalDate}</td>
              <td>${originCountry}</td>
              <td>${destinationCountry}</td>
              <td>${airplaneModel}</td>
              <td>${maxCapacity}</td>
              <td>${availablePassengers}</td>
            </tr>
          `;
          $("#flightTableBody").append(newRow);
          $("#addFlightModal").modal("hide");
        });
      });
    </script>
  </body>
</html>
